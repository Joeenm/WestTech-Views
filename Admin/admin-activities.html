<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gesti√≥n de Actividades - WestTech Social</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="flex bg-gray-100 min-h-screen">

  <!-- Sidebar -->
  <aside class="w-64 bg-blue-800 text-white flex flex-col">
    <div class="p-6 text-2xl font-bold border-b border-blue-700">WestTech Social</div>
    <nav class="flex-1 p-4 space-y-2">
      <a href="admin-dashboard.html" class="block py-2 px-3 rounded-lg hover:bg-blue-700">üìä Dashboard</a>
      <a href="admin-activities.html" class="block py-2 px-3 rounded-lg bg-blue-700">üóìÔ∏è Gesti√≥n de Actividades</a>
      <a href="admin-postulations.html" class="block py-2 px-3 rounded-lg hover:bg-blue-700">üë• Postulaciones</a>
    </nav>
    <div class="p-4 border-t border-blue-700">
      <button class="w-full bg-red-600 hover:bg-red-700 py-2 rounded-lg">Cerrar Sesi√≥n</button>
    </div>
  </aside>

  <!-- Contenido principal -->
  <main class="flex-1 p-8">

    <h1 class="text-3xl font-semibold text-blue-800 mb-6">Gesti√≥n de Actividades</h1>

    <!-- Bot√≥n Nueva Actividad -->
    <div class="flex justify-between items-center mb-4">
      <button id="btnNueva" class="bg-blue-700 text-white px-5 py-2 rounded-lg hover:bg-blue-800 transition">
        ‚ûï Nueva Actividad
      </button>
      <input type="text" id="filtro" placeholder="üîç Buscar actividad..." class="p-2 border rounded-lg w-64 focus:ring-2 focus:ring-blue-400" />
    </div>

    <!-- Tabla de actividades -->
    <div class="bg-white rounded-xl shadow-lg p-6">
      <h2 class="text-2xl font-semibold text-gray-800 mb-4">Actividades Publicadas</h2>

      <div class="overflow-x-auto">
        <table id="tablaActividades" class="min-w-full border border-gray-200">
          <thead class="bg-blue-800 text-white">
            <tr>
              <th class="py-2 px-3 text-left">Nombre</th>
              <th class="py-2 px-3 text-left">Encargado</th>
              <th class="py-2 px-3 text-left">Fecha</th>
              <th class="py-2 px-3 text-left">Horas</th>
              <th class="py-2 px-3 text-left">Cupos</th>
              <th class="py-2 px-3 text-center">Acciones</th>
            </tr>
          </thead>
          <tbody class="divide-y" id="bodyTabla">
            <tr class="hover:bg-gray-50">
              <td class="py-2 px-3">Apoyo Feria Cient√≠fica</td>
              <td class="py-2 px-3">Lic. Garc√≠a</td>
              <td class="py-2 px-3">2025-11-05</td>
              <td class="py-2 px-3">10</td>
              <td class="py-2 px-3">5</td>
              <td class="py-2 px-3 text-center space-x-2">
                <button class="bg-yellow-500 text-white px-3 py-1 rounded hover:bg-yellow-600 btnEditar">Editar</button>
                <button class="bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700 btnVer">Ver Detalles</button>
              </td>
            </tr>
            <tr class="hover:bg-gray-50">
              <td class="py-2 px-3">Limpieza de Playa</td>
              <td class="py-2 px-3">Ing. P√©rez</td>
              <td class="py-2 px-3">2025-10-20</td>
              <td class="py-2 px-3">8</td>
              <td class="py-2 px-3">0</td>
              <td class="py-2 px-3 text-center space-x-2">
                <button class="bg-yellow-500 text-white px-3 py-1 rounded hover:bg-yellow-600 btnEditar">Editar</button>
                <button class="bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700 btnVer">Ver Detalles</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </main>

  <!-- MODAL CREAR / EDITAR ACTIVIDAD -->
  <div id="modalActividad" class="hidden fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50">
    <div class="bg-white rounded-xl shadow-lg p-6 w-full max-w-3xl">
      <h2 id="tituloModal" class="text-2xl font-semibold text-gray-800 mb-4">Nueva Actividad</h2>

      <form id="formActividad" class="grid grid-cols-1 md:grid-cols-2 gap-6">

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Nombre de la Actividad *</label>
          <input id="nombre" type="text" required class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-400">
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Encargado *</label>
          <input id="encargado" type="text" required class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-400">
        </div>

        <div class="md:col-span-2">
          <label class="block text-sm font-medium text-gray-700 mb-1">Descripci√≥n *</label>
          <textarea id="descripcion" rows="3" required class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-400"></textarea>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Ubicaci√≥n *</label>
          <input id="ubicacion" type="text" required class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-400">
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Disponibilidad de veh√≠culo</label>
          <select id="vehiculo" class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-400">
            <option>S√≠</option>
            <option>No</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Fecha y Hora *</label>
          <input id="fecha" type="datetime-local" required class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-400">
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Horas Otorgadas *</label>
          <input id="horas" type="number" min="1" required class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-400">
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Cupos Disponibles *</label>
          <input id="cupos" type="number" min="1" required class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-400">
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Impacto</label>
          <input id="impacto" type="text" class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-400">
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Contribuci√≥n al Desarrollo Sostenible</label>
          <input id="contribucion" type="text" class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-400">
        </div>

        <div class="md:col-span-2">
          <label class="block text-sm font-medium text-gray-700 mb-1">Perfil del Estudiante</label>
          <textarea id="perfil" rows="2" class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-400"></textarea>
        </div>

        <div class="md:col-span-2">
          <label class="block text-sm font-medium text-gray-700 mb-1">Anuncio Importante</label>
          <textarea id="anuncio" rows="2" class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-400"></textarea>
        </div>

        <div class="md:col-span-2 flex justify-end gap-3">
          <button type="button" id="btnCancelar" class="bg-gray-400 text-white px-4 py-2 rounded hover:bg-gray-500">Cancelar</button>
          <button type="submit" id="btnGuardar" class="bg-blue-700 text-white px-6 py-2 rounded-lg hover:bg-blue-800">Registrar</button>
        </div>
      </form>
    </div>
  </div>

<!-- MODAL DETALLES -->
<div id="modalDetalles" class="hidden fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50">
  <div class="bg-white rounded-xl shadow-lg p-6 w-full max-w-2xl overflow-y-auto max-h-[90vh]">
    <h2 class="text-2xl font-semibold text-gray-800 mb-4">Detalles de la Actividad</h2>
    <div id="contenidoDetalles" class="space-y-3 text-gray-700"></div>
    <div class="text-right mt-6">
      <button id="cerrarDetalles" class="bg-blue-700 text-white px-4 py-2 rounded hover:bg-blue-800">Cerrar</button>
    </div>
  </div>
</div>

<script>
// ==== MODALES ====
const modal = document.getElementById("modalActividad");
const modalDetalles = document.getElementById("modalDetalles");
const form = document.getElementById("formActividad");
const tituloModal = document.getElementById("tituloModal");
const btnGuardar = document.getElementById("btnGuardar");
const filtro = document.getElementById("filtro");
const bodyTabla = document.getElementById("bodyTabla");

// ==== CONTENEDOR DE ALERTAS ====
const alertContainer = document.createElement("div");
alertContainer.className = "fixed top-5 right-5 z-[100] space-y-3";
document.body.appendChild(alertContainer);

// ==== FUNCI√ìN DE ALERTA PERSONALIZADA ====
function mostrarAlerta(mensaje, tipo = "info", duracion = 4000) {
  const colores = {
    success: "bg-green-600 border-green-700",
    warning: "bg-yellow-500 border-yellow-600",
    error: "bg-red-600 border-red-700",
    info: "bg-blue-600 border-blue-700",
  };

  const alerta = document.createElement("div");
  alerta.className = `
    flex items-center justify-between text-white px-4 py-3 rounded-lg shadow-lg border 
    animate-fadeIn ${colores[tipo] || colores.info}
  `;
  alerta.innerHTML = `
    <span class="font-medium">${mensaje}</span>
    <button class="ml-4 text-xl font-bold leading-none hover:opacity-75">&times;</button>
  `;

  alertContainer.appendChild(alerta);

  // Cerrar manualmente
  alerta.querySelector("button").onclick = () => alerta.remove();

  // Cerrar autom√°ticamente
  setTimeout(() => {
    alerta.classList.add("animate-fadeOut");
    setTimeout(() => alerta.remove(), 500);
  }, duracion);
}

// ==== ANIMACIONES TAILWIND ====
const style = document.createElement("style");
style.textContent = `
@keyframes fadeIn { from {opacity: 0; transform: translateY(-5px);} to {opacity: 1; transform: translateY(0);} }
@keyframes fadeOut { from {opacity: 1; transform: translateY(0);} to {opacity: 0; transform: translateY(-5px);} }
.animate-fadeIn { animation: fadeIn 0.3s ease-out forwards; }
.animate-fadeOut { animation: fadeOut 0.3s ease-in forwards; }
`;
document.head.appendChild(style);

// ==== EVENTOS ====
document.getElementById("btnNueva").onclick = () => {
  modal.classList.remove("hidden");
  tituloModal.textContent = "Nueva Actividad";
  btnGuardar.textContent = "Registrar";
  form.reset();
};

document.getElementById("btnCancelar").onclick = () => modal.classList.add("hidden");

// ==== VALIDACI√ìN Y ENV√çO ====
form.onsubmit = (e) => {
  e.preventDefault();
  const camposObligatorios = ["nombre", "encargado", "descripcion", "ubicacion", "fecha", "horas", "cupos"];
  const incompletos = camposObligatorios.some(id => !document.getElementById(id).value.trim());

  if (incompletos) {
    mostrarAlerta("‚ö†Ô∏è Termine de completar los datos para registrar la actividad.", "warning");
    return;
  }

  mostrarAlerta(
    btnGuardar.textContent === "Registrar"
      ? "‚úÖ Actividad registrada con √©xito."
      : "‚úÖ Los datos se han actualizado correctamente.",
    "success"
  );

  modal.classList.add("hidden");
};

// ==== FILTRO ====
filtro.addEventListener("input", e => {
  const filtroTexto = e.target.value.toLowerCase();
  Array.from(bodyTabla.rows).forEach(row => {
    const nombre = row.cells[0].textContent.toLowerCase();
    row.style.display = nombre.includes(filtroTexto) ? "" : "none";
  });
});

// ==== VER DETALLES ====
bodyTabla.addEventListener("click", e => {
  if (e.target.classList.contains("btnEditar")) {
    modal.classList.remove("hidden");
    tituloModal.textContent = "Editar Actividad";
    btnGuardar.textContent = "Actualizar";
  } else if (e.target.classList.contains("btnVer")) {
    modalDetalles.classList.remove("hidden");
    const row = e.target.closest("tr");

    const detalles = {
      nombre: row.cells[0].textContent,
      encargado: row.cells[1].textContent,
      descripcion: "Actividad de apoyo log√≠stico en el evento de bienvenida de nuevos estudiantes.",
      ubicacion: "Auditorio Principal - UTP CRPO",
      vehiculo: "No requerido",
      fecha: "2025-10-25 - 08:00 a.m.",
      horas: row.cells[3].textContent + " horas",
      impacto: "Promueve la integraci√≥n y el sentido de pertenencia estudiantil.",
      contribucion: "ODS 4 - Educaci√≥n de calidad",
      perfil: "Estudiantes con habilidades de organizaci√≥n y comunicaci√≥n.",
      cupos: row.cells[4].textContent,
      anuncio: "Llevar camisa blanca y jeans azul el d√≠a del evento.",
    };

    document.getElementById("contenidoDetalles").innerHTML = `
      <p><strong>Nombre:</strong> ${detalles.nombre}</p>
      <p><strong>Descripci√≥n:</strong> ${detalles.descripcion}</p>
      <p><strong>Ubicaci√≥n:</strong> ${detalles.ubicacion}</p>
      <p><strong>Disponibilidad de Veh√≠culo:</strong> ${detalles.vehiculo}</p>
      <p><strong>Fecha y Hora:</strong> ${detalles.fecha}</p>
      <p><strong>Horas Otorgadas:</strong> ${detalles.horas}</p>
      <p><strong>Impacto:</strong> ${detalles.impacto}</p>
      <p><strong>Contribuci√≥n al Desarrollo Sostenible:</strong> ${detalles.contribucion}</p>
      <p><strong>Perfil del Estudiante:</strong> ${detalles.perfil}</p>
      <p><strong>Cupos Disponibles:</strong> ${detalles.cupos}</p>
      <p><strong>Anuncio Importante:</strong> ${detalles.anuncio}</p>
      <p><strong>Encargado:</strong> ${detalles.encargado}</p>
    `;
  }
});

document.getElementById("cerrarDetalles").onclick = () => modalDetalles.classList.add("hidden");
</script>

</body>
</html>
